<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Testing the Tests" /><meta property="og:locale" content="en" /><meta name="description" content="If we use tests to test code, how can we test our tests?" /><meta property="og:description" content="If we use tests to test code, how can we test our tests?" /><link rel="canonical" href="https://mzampetakis.com/posts/Testing-the-Tests/" /><meta property="og:url" content="https://mzampetakis.com/posts/Testing-the-Tests/" /><meta property="og:site_name" content="Michalis Zampetakis" /><meta property="og:image" content="https://mzampetakis.com/assets/posts/Testing-the-Tests/mobius.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-09-11T02:15:00+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://mzampetakis.com/assets/posts/Testing-the-Tests/mobius.jpg" /><meta property="twitter:title" content="Testing the Tests" /><meta name="twitter:site" content="@mzampetakis" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-20T02:50:32+08:00","datePublished":"2021-09-11T02:15:00+08:00","description":"If we use tests to test code, how can we test our tests?","headline":"Testing the Tests","image":{"show_in_post":false,"url":"https://mzampetakis.com/assets/posts/Testing-the-Tests/mobius.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mzampetakis.com/posts/Testing-the-Tests/"},"url":"https://mzampetakis.com/posts/Testing-the-Tests/"}</script><title>Testing the Tests | Michalis Zampetakis</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Michalis Zampetakis"><meta name="application-name" content="Michalis Zampetakis"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sample/me.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Michalis Zampetakis</a></div><div class="site-subtitle font-italic">Curiosity Driven</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/now/" class="nav-link"> <i class="fa-fw fas fa-clock ml-xl-3 mr-xl-3 unloaded"></i> <span>NOW</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/mzampetakis" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/mzampetakis" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mzampetakis','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="linkedin" > <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Testing the Tests</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Testing the Tests</h1><div class="post-meta text-muted"><div></div><div class="d-flex"><div> <span> Posted <em class="timeago" inalid-data-ts="1631297700" > Sep 11, 2021 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1540 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>If we use tests to test code, how can we test our tests? We write tests in order to assure the quality of the software we are writing. Software developers are usually trying to reach a certain level of code coverage through their tests. However, the quality of the tests is not usually measured or examined through this process. It is possible that someone could achieve a 100% code coverage even without any assertion at all!</p><h2 id="is-it-fully-tested"><span class="mr-2">Is it Fully Tested?</span><a href="#is-it-fully-tested" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In a simple example we have a <a href="https://en.wikipedia.org/wiki/Fizz_buzz">fizzbuzz</a> implementation where given an integer we return the desired string result:</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">fizzbuzz</span>

<span class="k">import</span> <span class="s">"strconv"</span>

<span class="c">// CalculateFizzBuzz returns</span>
<span class="c">// `fizz` if the given number is divisible by 3</span>
<span class="c">// `buzz` if the given number is divisible by 5</span>
<span class="c">// `fizzbuzz` if the given number is divisible by 3 and 5</span>
<span class="c">// empty string if it is non positive</span>
<span class="c">// else the number itself.</span>
<span class="k">func</span> <span class="n">CalculateFizzBuzz</span><span class="p">(</span><span class="n">num</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="n">ret</span> <span class="o">:=</span> <span class="s">""</span>
	<span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="m">0</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">ret</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">num</span><span class="o">%</span><span class="m">3</span> <span class="o">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="s">"fizz"</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">num</span><span class="o">%</span><span class="m">5</span> <span class="o">==</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">+=</span> <span class="s">"buzz"</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">num</span><span class="o">%</span><span class="m">3</span> <span class="o">!=</span> <span class="m">0</span> <span class="o">&amp;&amp;</span> <span class="n">num</span><span class="o">%</span><span class="m">5</span> <span class="o">!=</span> <span class="m">0</span> <span class="p">{</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">strconv</span><span class="o">.</span><span class="n">Itoa</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ret</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Testing this function seems straight forward. We have to test all the <code class="language-plaintext highlighter-rouge">if</code> statements of the function. Using table testing technique we can have the following result for our test cases:</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">fizzbuzz</span>

<span class="k">import</span> <span class="s">"testing"</span>

<span class="k">func</span> <span class="n">TestCalculateFizzBuzz</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">var</span> <span class="n">tt</span> <span class="o">=</span> <span class="p">[]</span><span class="k">struct</span> <span class="p">{</span>
		<span class="n">name</span>     <span class="kt">string</span>
		<span class="n">given</span>    <span class="kt">int</span>
		<span class="n">expected</span> <span class="kt">string</span>
	<span class="p">}{</span>
		<span class="p">{</span>
			<span class="n">name</span><span class="o">:</span>     <span class="s">"Given -1 expects empty string."</span><span class="p">,</span>
			<span class="n">given</span><span class="o">:</span>    <span class="o">-</span><span class="m">1</span><span class="p">,</span>
			<span class="n">expected</span><span class="o">:</span> <span class="s">""</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 3 expects fizz."</span><span class="p">,</span>
			<span class="n">given</span><span class="o">:</span>    <span class="m">3</span><span class="p">,</span>
			<span class="n">expected</span><span class="o">:</span> <span class="s">"fizz"</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 5 expects buzz."</span><span class="p">,</span>
			<span class="n">given</span><span class="o">:</span>    <span class="m">5</span><span class="p">,</span>
			<span class="n">expected</span><span class="o">:</span> <span class="s">"buzz"</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 15 expects fizzbuzz."</span><span class="p">,</span>
			<span class="n">given</span><span class="o">:</span>    <span class="m">15</span><span class="p">,</span>
			<span class="n">expected</span><span class="o">:</span> <span class="s">"fizzbuzz"</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 7 expects 7."</span><span class="p">,</span>
			<span class="n">given</span><span class="o">:</span>    <span class="m">7</span><span class="p">,</span>
			<span class="n">expected</span><span class="o">:</span> <span class="s">"7"</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">tc</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">tt</span> <span class="p">{</span>
		<span class="n">t</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="k">func</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span><span class="n">testing</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">{</span>
			<span class="c">//Test</span>
			<span class="n">got</span> <span class="o">:=</span> <span class="n">CalculateFizzBuzz</span><span class="p">(</span><span class="n">tc</span><span class="o">.</span><span class="n">given</span><span class="p">)</span>
			<span class="c">//Assert</span>
			<span class="k">if</span> <span class="n">got</span> <span class="o">!=</span> <span class="n">tc</span><span class="o">.</span><span class="n">expected</span> <span class="p">{</span>
				<span class="n">t</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"expected: %s, got: %s, for CalculateFizzBuzz of %d"</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">expected</span><span class="p">,</span> <span class="n">got</span><span class="p">,</span> <span class="n">tc</span><span class="o">.</span><span class="n">given</span><span class="p">)</span>
			<span class="p">}</span>
		<span class="p">})</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Test coverage can be seen by executing these commands:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>go test -coverprofile cover.out 
go tool cover -html=cover.out
</pre></table></code></div></div><p>and the result is:</p><p><img data-src="/assets/posts/Testing-the-Tests/coverage1.png" alt="Coverage #1" data-proofer-ignore></p><p>As we see our code is 100% covered by tests. Does this mean that we are safe to do any change to our code with the safety net of our tests? Absolutely not!</p><p>Let’s see a simple example. Changing the line <code class="language-plaintext highlighter-rouge">if num &lt;= 0 {</code> to <code class="language-plaintext highlighter-rouge">if num &lt; 0 {</code> will still let all the tests to pass successfully, however, we just changed our function’s behavior with unexpected results in the execution.</p><p>Lets see another example. Removing these test cases:</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="p">{</span>
	<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 5 expects buzz."</span><span class="p">,</span>
	<span class="n">given</span><span class="o">:</span>    <span class="m">5</span><span class="p">,</span>
	<span class="n">expected</span><span class="o">:</span> <span class="s">"buzz"</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
	<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 15 expects fizzbuzz."</span><span class="p">,</span>
	<span class="n">given</span><span class="o">:</span>    <span class="m">15</span><span class="p">,</span>
	<span class="n">expected</span><span class="o">:</span> <span class="s">"fizzbuzz"</span><span class="p">,</span>
<span class="p">},</span>
</pre></table></code></div></div><p>will also leave our coverage untouched and up to 100%. However, we have missed out to test specific cases of our function.</p><p>There is one certain technique that allows us to detect such cases. This technique involves the process to apply minor changes to our function and then check if the existing tests fail on each one of those! This process can be automated through mutation testing!</p><h2 id="mutation-to-the-rescue"><span class="mr-2">Mutation to the rescue!</span><a href="#mutation-to-the-rescue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Mutation testing is used to design new software tests and evaluate the quality of existing software tests. Mutation testing involves modifying a program in small ways. Each mutated version is called a mutant and tests detect and reject mutants by causing the behavior of the original version to differ from the mutant. This is called killing the mutant. Test suites are measured by the percentage of mutants that they kill. New tests can be designed to kill additional mutants. Mutants are based on well-defined mutation operators that either mimic typical programming errors (such as using the wrong operator or variable name) or force the creation of valuable tests (such as dividing each expression by zero). The purpose is to help the tester develop effective tests or locate weaknesses in the test data used for the program or in sections of the code that are seldom or never accessed during execution. Mutation testing is a form of white-box testing. (https://en.wikipedia.org/wiki/Mutation_testing)</p><p>The mutation testing can be automated through a mutation library. Such libraries mutate the source code in minor ways through a specific rule-set and then they run the same tests against the produced mutant. In our case we used the <a href="https://github.com/zimmski/go-mutesting">go-mutesting library</a> to run such a process.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>&gt;&gt; go-mutesting/fizbuzz.go
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.0" with checksum 8f404742ff5b871908bdf580620787c2
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.1" with checksum df615b5ba4c9d06bb54cf605730d89b8
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.2" with checksum 15e3b2a8de455eed5e05c73dbbf1263f
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.3" with checksum 933cd06e194200a78f53199c1d3ddfb6
--- fizzbuzz/fizbuzz.go	2021-09-07 11:48:32.000000000 +0300
+++ /var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.4	2021-09-07 22:37:29.000000000 +0300
@@ -10,7 +10,7 @@
 // else the number itself.
 func CalculateFizzBuzz(num int) string {
 	ret := ""
-	if num &lt;= 0 {
+	if num &lt; 0 {
 		return ret
 	}
 	if num%3 == 0 {

FAIL "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.4" with checksum 9970f3c67a1e9211513823f2d4549314
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.5" with checksum a26848fafc97ee7d8ef7d7a497a12f82
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-718515268/fizzbuzz/fizbuzz.go.6" with checksum 802ed71e97906862491cfaf7a506754d
The mutation score is 0.857143 (6 passed, 1 failed, 3 duplicated, 0 skipped, total is 7)
</pre></table></code></div></div><p>We can see that <code class="language-plaintext highlighter-rouge">go-mutesting</code> produced 7 mutants of our source code and just one of those failed. In the failed one the altered line is mentioned as</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="o">-</span>	<span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="m">0</span> <span class="p">{</span>
<span class="o">+</span>	<span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="m">0</span> <span class="p">{</span>
</pre></table></code></div></div><p>We can fix this by altering our first test case to:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>{
	name:     "Given 0 expects empty string.",
	given:    0,
	expected: "",
},
</pre></table></code></div></div><p>Here is a demo of how our source code updated while running the mutation testing:</p><p><img data-src="/assets/posts/Testing-the-Tests/mutating.gif" alt="mutating source code" data-proofer-ignore></p><p>Also if we remove these test cases from our test (which also leaves code’s test coverage up to 100%):</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="p">{</span>
	<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 5 expects buzz."</span><span class="p">,</span>
	<span class="n">given</span><span class="o">:</span>    <span class="m">5</span><span class="p">,</span>
	<span class="n">expected</span><span class="o">:</span> <span class="s">"buzz"</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">{</span>
	<span class="n">name</span><span class="o">:</span>     <span class="s">"Given 15 expects fizzbuzz."</span><span class="p">,</span>
	<span class="n">given</span><span class="o">:</span>    <span class="m">15</span><span class="p">,</span>
	<span class="n">expected</span><span class="o">:</span> <span class="s">"fizzbuzz"</span><span class="p">,</span>
<span class="p">},</span>
</pre></table></code></div></div><p>and then run again the mutation testing we get this result:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre> &gt;&gt; go-mutesting fizzbuzz/fizbuzz.go
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.0" with checksum 8f404742ff5b871908bdf580620787c2
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.1" with checksum df615b5ba4c9d06bb54cf605730d89b8
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.2" with checksum 15e3b2a8de455eed5e05c73dbbf1263f
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.3" with checksum 933cd06e194200a78f53199c1d3ddfb6
PASS "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.4" with checksum 9970f3c67a1e9211513823f2d4549314
--- fizzbuzz/fizbuzz.go	2021-09-07 11:48:32.000000000 +0300
+++ /var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.5	2021-09-07 22:53:28.000000000 +0300
@@ -19,7 +19,7 @@
 	if num%5 == 0 {
 		ret += "buzz"
 	}
-	if num%3 != 0 &amp;&amp; num%5 != 0 {
+	if true &amp;&amp; num%5 != 0 {
 		ret = strconv.Itoa(num)
 	}
 	return ret

FAIL "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.5" with checksum a26848fafc97ee7d8ef7d7a497a12f82
--- fizzbuzz/fizbuzz.go	2021-09-07 11:48:32.000000000 +0300
+++ /var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.6	2021-09-07 22:53:28.000000000 +0300
@@ -19,7 +19,7 @@
 	if num%5 == 0 {
 		ret += "buzz"
 	}
-	if num%3 != 0 &amp;&amp; num%5 != 0 {
+	if num%3 != 0 &amp;&amp; true {
 		ret = strconv.Itoa(num)
 	}
 	return ret

FAIL "/var/folders/jh/nh1wg3r93xv94jd2bwz8lzc80000gn/T/go-mutesting-254713350/fizzbuzz/fizbuzz.go.6" with checksum 802ed71e97906862491cfaf7a506754d
The mutation score is 0.714286 (5 passed, 2 failed, 3 duplicated, 0 skipped, total is 7)
</pre></table></code></div></div><p>As we still have 100% test coverage, mutation testing revealed cases where our tests fail to catch such alterations to the source code.</p><blockquote><p>The mutation score is calculated as the percentage ration of (number of killed mutants)/(number of total mutants).</p></blockquote><h2 id="mutation-variations"><span class="mr-2">Mutation variations</span><a href="#mutation-variations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Each mutation testing library can produce mutants by applying specific changes on the source code based on various rules. The most popular ones are:</p><ul><li>Branch mutators<li>Expression mutators<li>Statement mutators</ul><p>It makes sense that mutation testing is pretty resource-intensive as there is a huge number of mutants that are usually generated for every code block.</p><p>Some mutations can cause a test not to finish, so generally, mutation libraries allow each test to run within a ten times compared to the original execution time.</p><p>Also many tests might generate false positives, so most of the libraries allows us to blacklist specific mutants in order to avoid noise in future runs.</p><h2 id="sum-up"><span class="mr-2">Sum Up</span><a href="#sum-up" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Even though we try to assure the quality of the software we are writing through the test, nothing validates the efficiency of the tests. Even code coverage of tests might be a misleading qualifier sometimes.</p><p>Mutation testing involves modifying a program in small ways so that to verify if tests cover each one of this variation (mutant). This way we can qualify if our tests are able to kill all of the mutants effectively.</p><p>The process of mutating a source code and running the test suite is a pretty resource-intensive process so we should consider how often we can run the mutation testing towards our codebase.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/golang/" class="post-tag no-text-decoration" >golang</a> <a href="/tags/coding/" class="post-tag no-text-decoration" >coding</a> <a href="/tags/testing/" class="post-tag no-text-decoration" >testing</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Testing+the+Tests+-+Michalis+Zampetakis&url=https%3A%2F%2Fmzampetakis.com%2Fposts%2FTesting-the-Tests%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Testing+the+Tests+-+Michalis+Zampetakis&u=https%3A%2F%2Fmzampetakis.com%2Fposts%2FTesting-the-Tests%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fmzampetakis.com%2Fposts%2FTesting-the-Tests%2F&text=Testing+the+Tests+-+Michalis+Zampetakis" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/testing/">testing</a> <a class="post-tag" href="/tags/blogging/">blogging</a> <a class="post-tag" href="/tags/image-processing/">image-processing</a> <a class="post-tag" href="/tags/lego/">LEGO</a> <a class="post-tag" href="/tags/oauth/">oAuth</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/time/">time</a> <a class="post-tag" href="/tags/toy-project/">toy-project</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Log-Requests-in-Go/"><div class="card-body"> <em class="timeago small" inalid-data-ts="1597696800" > Aug 18, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Log Requests in Go</h3><div class="text-muted small"><p> It’s a common sense that logging your HTTP request in your application is essential. The reasons for doing so are numerous. Error reporting, tracing, monitoring, performance tuning and so on. One ...</p></div></div></a></div><div class="card"> <a href="/posts/AquaGo-A-Toy-Project/"><div class="card-body"> <em class="timeago small" inalid-data-ts="1598902800" > Sep 1, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AquaGo - A Toy Project</h3><div class="text-muted small"><p> Just imagine if you could have on your living’s room TV an aquarium! Wouldn’t that be nice, especially during the hot period of summertime? What about if you could add digital fishes and decorative...</p></div></div></a></div><div class="card"> <a href="/posts/Testing-When-Time-Matters/"><div class="card-body"> <em class="timeago small" inalid-data-ts="1601142900" > Sep 27, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Testing When Time Matters</h3><div class="text-muted small"><p> Software testing undeniably can provide objective, independent information about the quality of software. However, the testing development process can sometimes be not straightforward. There are ca...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Exec-Command/" class="btn btn-outline-primary" prompt="Older"><p>Exec.Command</p></a> <a href="/posts/Embedding-VCS-Info-in-Binary/" class="btn btn-outline-primary" prompt="Newer"><p>Embedding VCS Info in Go binary</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://mzampetakis.com">Michalis Zampetakis</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme. Images from <a href="https://unsplash.com/" target="_blank" rel="noopener">Unsplash</a></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/golang/">golang</a> <a class="post-tag" href="/tags/coding/">coding</a> <a class="post-tag" href="/tags/testing/">testing</a> <a class="post-tag" href="/tags/blogging/">blogging</a> <a class="post-tag" href="/tags/image-processing/">image-processing</a> <a class="post-tag" href="/tags/lego/">LEGO</a> <a class="post-tag" href="/tags/oauth/">oAuth</a> <a class="post-tag" href="/tags/shell/">shell</a> <a class="post-tag" href="/tags/time/">time</a> <a class="post-tag" href="/tags/toy-project/">toy-project</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-172730569-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-172730569-1'); }); </script>
